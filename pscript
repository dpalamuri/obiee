Column Lineage

06 August 2018
22:00

OBIEE Metadata	->Repository Metadata
	->Report on Analysis from Catalog
	(Join both on Subject Area, Presentation Table, Presentation Column)
	
	To do:
	Import exported Metadata into Database tables
	How Physical table Views are exported as metadata in repository metadata
OBIEE Metadata	Direct database queries (XML Search)
BIP Metadata	
Scenario:	
DM - Database Query	-> List of Physical tables/Columns to lookup for
DM - Report on OBIEE Physical layer	-> List of Physical tables/Columns to lookup for
DM - Report on OBIEE Presentation layer(logical SQL)	-> List of Presentation tables/Columns to lookup for
DM - Report on OBIEE Analysis (logical SQL)	-> List of Presentation tables/Columns to lookup for
DM - Report on Procedures	-> List of Procedures to lookup for
	
	To do:
	Is Catalog export viable ?
	Are all of BIP Data models stored in '_datamodel' files ?
	How to search for reports using Data Models
Usage tracking integration	To do:
	How to usage track BIP reports ?

Commands:

Create Catalog report on Analysis : Linux Commands
Offline:
/app/oracle/biee/user_projects/domains/bi/bitools/bin/runcat.sh -cmd report -offline ~/working/obidata/catalog \
-forceoutputFile ~/working/columnlineage/analysis_report -delimiter '^^' \
-type "Analysis" -fields  "Name:Folder:Path:Subject Area:Table:Column:Formula:Owner:SAW Variables:RPD Variables:Session Variables" \
-childrenType "Filter" -childrenFields "Path:Owner:Subject Area:Table:Column"
-folder /shared/zdurga/columnlineage 

Online
/app/oracle/biee/user_projects/domains/bi/bitools/bin/runcat.sh -cmd report -online http://bivm:7780/analytics/saw.dll -credentials ~/working/columnlineage/cred.txt \
-forceoutputFile ~/working/columnlineage/analysis_report_online -delimiter '^^' \
-type "Analysis" -fields  "Name:Folder:Path:Subject Area:Table:Column:Formula:SQL:Owner:SAW Variables:RPD Variables:Session Variables" \
-childrenType "Filter" -childrenFields "Path:Owner:Subject Area:Table:Column"
-folder /shared/zdurga/columnlineage 
-----------------------cred.txt-----------------------
login=prodney
pwd=Admin123
---------------------------------------------------------

Commands in one line:
/app/oracle/biee/user_projects/domains/bi/bitools/bin/runcat.sh -cmd report -offline ~/working/obidata/catalog -forceoutputFile ~/working/columnlineage/analysis_report -delimiter '^^'  -type "Analysis" -fields  "Name:Folder:Path:Subject Area:Table:Column:Formula:SQL:Owner:SAW Variables:RPD Variables:Session Variables" 

/app/oracle/biee/user_projects/domains/bi/bitools/bin/runcat.sh -cmd report -online http://bivm:7780/analytics -credentials ~/working/columnlineage/cred.txt -forceoutputFile ~/working/columnlineage/analysis_report_online -delimiter '^^' -type "Analysis" -fields  "Name:Folder:Path:Subject Area:Table:Column:Formula:SQL:Owner:SAW Variables:RPD Variables:Session Variables" 
Create Catalog report on Analysis : Windows Commands
Note: Don't give delimiter in quotes.

Windows
D:\app\BIClient\bi\bitools\bin\runcat.cmd
D:\Workspace\OBIEE\bivm\catalog
D:\workspace\obiee\columnlineage\analysis_report
D:\workspace\obiee\columnlineage\analysis_report_online
 
Offline:
D:\app\BIClient\bi\bitools\bin\runcat.cmd -cmd report -offline D:\Workspace\OBIEE\bivm\catalog -forceoutputFile D:\workspace\obiee\columnlineage\analysis_report -delimiter :::: -type "Analysis" -fields  "Name:Folder:Path:Subject Area:Table:Column:Formula:Owner:SAW Variables:RPD Variables:Session Variables" 
-childrenType "Filter" -childrenFields "Path:Owner:Subject Area:Table:Column"
-folder /shared/zdurga/columnlineage 

Online
D:\app\BIClient\bi\bitools\bin\runcat.cmd -cmd report -online http://bivm:7780/analytics -credentials D:\workspace\obiee\columnlineage\cred.txt -forceoutputFile D:\workspace\obiee\columnlineage\analysis_report_online -delimiter :::: -type "Analysis" -fields  "Name:Folder:Path:Subject Area:Table:Column:Formula:SQL:Owner:SAW Variables:RPD Variables:Session Variables"
-childrenType "Filter" -childrenFields "Path:Owner:Subject Area:Table:Column"
-folder /shared/zdurga/columnlineage 
XML Search

find . -type f -not -name \*.atr -exec file '{}' \; | grep 'XML' | awk '{print substr($1,0,length($1)-1)}'|xargs grep -li -f '<file_name>'
 <dataModel url="/05. Published Reporting/a. Overview/Data Models/Salary Parameter Datamodel.xdm"/>


Catalog export options:
All Types	"Folder",  "Name",  "Path"
	"Created", "Creator", "Modified", "Modifier", "Owner", "ACL", "Description", "Signature",, 
	"Description ID", "Size", "Caption ID",  "Tag", "Properties", "Internal Properties", "Content State" 
if -type is "Analysis"	"Table", "Column", "Subject Area", "Formula", "SAW Variables", "RPD Variables", "Session Variables" 
	"SQL", "Missing Column IDs", "Unused Column IDs" 
If -type is "Dashboard Prompt"	"Formula", "Table", "Column", "Subject Area" 
If -type is "Filter"	"Formula", "Table", "Column", "Subject Area" 

Export Catalog and repository Metadata
Process exported Rep and Catalog metadata
	Make sure delimiters properly separating columns
	is quoting for " ' " necessary with set define off
	Is quoting for '&' necessary with set define off
	Quotes all columns with single quotes
	Separate Physical_Table from 'Select Statements'
	Load CLOB columns for both 'SQL' and 'Formula'
	Identify Tables from the Select Query
	
Load to database
	Create database tables 
Column lineage
	OBIEE Analysis
	OBIEE Direct database requests
	BIP Reports( Direct SQL, RPD based logical, Physical SQL)
